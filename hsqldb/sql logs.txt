create table CLIENTS
(
ID uuid constraint CLIENTS_pk primary key,
NAME nvarchar(30) NOT NULL,
SECOND_NAME nvarchar(30) NOT NULL,
PATRONYMIC nvarchar(30),
PHONE_NUMBER nvarchar(20) NOT NULL,
EMAIL nvarchar(50) NOT NULL,
PASSPORT_ID nvarchar(10) NOT NULL
);

create table CREDITS
(
ID uuid constraint CREDITS_pk primary key,
CREDIT_LIMIT bigint NOT NULL,
INTEREST_RATE float NOT NULL
);

create table CREDIT_OFFER
(
ID uuid constraint CREDIT_OFFER_pk primary key,
CLIENT_ID uuid NOT NULL,
CREDIT_ID uuid NOT NULL,
CREDIT_SUM bigint NOT NULL,
);

ALTER TABLE CREDIT_OFFER ADD FOREIGN KEY (CLIENT_ID) REFERENCES CLIENTS(ID)
ON DELETE CASCADE
ON UPDATE CASCADE;

ALTER TABLE CREDIT_OFFER ADD FOREIGN KEY (CREDIT_ID) REFERENCES CREDITS(ID)
ON DELETE RESTRICT
ON UPDATE CASCADE;

INSERT INTO "PUBLIC"."CLIENTS"
( "ID", "NAME", "SECOND_NAME", "PATRONYMIC", "PHONE_NUMBER", "EMAIL", "PASSPORT_ID" )
VALUES (UUID(), 'Oleg', 'Philimonov', 'Ivanovich', '89016107200', 'oleg.phil@mail.ru', '4620571489')

INSERT INTO "PUBLIC"."CREDITS"
( "ID", "CREDIT_LIMIT", "INTEREST_RATE" )
VALUES (UUID() ,10000000 , 20.5)

INSERT INTO "PUBLIC"."CREDITS"
( "ID", "CREDIT_LIMIT", "INTEREST_RATE" )
VALUES (UUID(), 500000, 15)

INSERT INTO "PUBLIC"."CREDIT_OFFER"
( "ID", "CLIENT_ID", "CREDIT_ID", "CREDIT_SUM" )
VALUES (UUID(), 'a1c712d1-0f22-44b1-a159-66bf05c212c5', '91fdf645-f4ed-45d8-a9ca-6ed437778c59', 7000000)

/*
create table PAYMENT_SCHEDULE
(
ID uuid constraint PAYMENT_SCHEDULE_pk primary key,
PAYMENT_DATE datetime NOT NULL,
PAYMENT_SUM decimal NOT NULL,
LOAN_BODY_SUM decimal NOT NULL,
INTEREST_SUM decimal NOT NULL,
);
*/

/*
create table BANK
(
ID uuid constraint BANK_pk primary key,
CLIENT_ID uuid NOT NULL,
CREDIT_ID uuid NOT NULL
);
*/

/*
ALTER TABLE CREDIT_OFFER ADD FOREIGN KEY (PAYMENT_SCHEDULE_ID) REFERENCES PAYMENT_SCHEDULE(ID)
ON DELETE RESTRICT
ON UPDATE CASCADE;
*/

/*
ALTER TABLE BANK ADD FOREIGN KEY (CLIENT_ID) REFERENCES CLIENTS(ID)
ON DELETE RESTRICT
ON UPDATE CASCADE;

ALTER TABLE BANK ADD FOREIGN KEY (CREDIT_ID) REFERENCES CREDITS(ID)
ON DELETE RESTRICT
ON UPDATE CASCADE;
*/

/*
create trigger CREDIT_OFFER_DELETE after delete on CREDIT_OFFER
delete from table PUBLIC.CLIENTS where ID = d.CLIENT_ID
from DELETED d
*/